# ğŸ“š PDF Q&A Assistant using LangChain, FAISS, and Gemini LLM

A smart conversational assistant that allows users to query PDF documents with natural language. It uses **LangChain**, **FAISS**, and **Gemini (Google Generative AI)** to retrieve and generate precise answers from PDF content. If the document lacks enough information, it intelligently falls back to the internet for a reliable answer.

---

## ğŸ¯ Project Aim
--------------------------------------------------------------------------------------

To build an intelligent chatbot that:
- Understands and answers questions based on the content of a given PDF (e.g., books, manuals, reports).
- Ensures the answers are grounded in document content using semantic search, heuristic checks, and LLM reranking.
- Provides internet-sourced fallback answers when the document information is insufficient.

---

## ğŸš€ Features
------------------------------------------------------------------------------------------------

âœ… **PDF Ingestion**  
- Loads and splits PDF into meaningful chunks using LangChain's `PyPDFLoader` and `RecursiveCharacterTextSplitter`.

âœ… **Semantic Vector Search**  
- Embeds document chunks using `all-mpnet-base-v2` Sentence Transformer.
- Stores and retrieves chunks using FAISS for fast, similarity-based searching.

âœ… **Q&A with Gemini LLM**  
- Uses `Gemini 1.5 Flash` for generating responses.
- Queries PDF via a `RetrievalQA` chain with LangChain.

âœ… **Confidence Scoring**  
- Uses a length-based heuristic to check if the answer is well-supported by the PDF content.
- Reranks answers using an LLM prompt to validate answer quality.

âœ… **Fallback to Internet Search**  
- Uses DuckDuckGo search when the PDF content isn't sufficient or reliable.

âœ… **Chainlit Frontend**  
- Engaging conversational UI powered by Chainlit.
- Shows source snippets with clickable page links from the original PDF.

---

## ğŸ› ï¸ How It Works
------------------------------------------------------------------------------------------------

1. **PDF Preprocessing (`main.py`)**
   - The PDF is loaded and split into chunks using LangChainâ€™s `PyPDFLoader` and `RecursiveCharacterTextSplitter`.
   - Each chunk is embedded using a Sentence Transformer model (`all-mpnet-base-v2`).
   - The chunks and their embeddings are stored in a FAISS vector store for efficient similarity search.

2. **Chat Session Starts (`chainlitapp.py`)**
   - Chainlit launches a conversational UI.
   - The Gemini LLM and FAISS retriever are initialized.
   - A friendly welcome message invites the user to ask questions.

3. **Question Handling**
   - The user submits a question.
   - LangChainâ€™s `RetrievalQA` retrieves relevant chunks from the FAISS store.
   - Gemini LLM generates an answer based on those chunks.

4. **Confidence Checks**
   - **Heuristic Check**: Measures how well the length of the PDF chunks supports the generated answer.
   - **LLM Reranking**: The Gemini LLM is asked to evaluate if the answer is grounded in the retrieved chunks.

5. **Hybrid Decision Logic**
   - If both checks pass: âœ… The answer is shown along with source links to the PDF pages.
   - If not: âŒ The system uses DuckDuckGo to search the web and returns an internet-based answer instead.

6. **PDF Source Links**
   - The app generates page-specific links using `pdf.js`, so users can directly view the original content.

---

## ğŸ§  Architecture Overview
----------------------------------------------------------------------------------------------------

```text
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   PDF Document     â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  load_and_split_pdf â”‚ â†â”€ PyPDFLoader + RecursiveCharacterTextSplitter
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   FAISS Vector DB   â”‚ â†â”€ SentenceTransformerEmbeddings
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚      RetrievalQA + Gemini LLM   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Length Heuristic + LLM Reranking      â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       No        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PDF Answer â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   Internet Fallback     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜




---

## ğŸ§± Tech Stack
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------

| Component            | Description                                    |
|----------------------|------------------------------------------------|
| `LangChain`          | Chain logic + retrieval QA                    |
| `FAISS`              | Vector store for chunk embeddings              |
| `SentenceTransformer`| Embedding model (`all-mpnet-base-v2`)          |
| `Gemini Pro`         | LLM from Google Generative AI                  |
| `DuckDuckGo Tools`   | Internet search fallback                       |
| `Chainlit`           | Chat-based frontend for LLM apps               |
| `PyPDFLoader`        | For loading and splitting PDFs                 |

---

## âš™ï¸ Setup Instructions
----------------------------------------------------------------------



```bash
git clone https://github.com/your-repo/smartdoc-chatbot.git
cd smartdoc-chatbot
pip install -r requirements.txt
Create a .env file:

GOOGLE_API_KEY=your_google_api_key_here
Run preprocessing:-
python main.py
Start chatbot:-
chainlit run chainlit_app.py --port 8000

ğŸ“ Folder Structure
-----------------------------------------------------
.
â”œâ”€â”€ main.py                # Preprocess and index PDF
â”œâ”€â”€ chainlit_app.py        # Chat app and agent logic
â”œâ”€â”€ pdf_utils.py           # PDF loading and chunking
â”œâ”€â”€ vectordb_utils.py      # FAISS DB operations
â”œâ”€â”€ data/ml_book.pdf       # PDF file
â”œâ”€â”€ .env                   # API key
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md


âœ… Example Prompts
-----------------------------------------------------------------
"what is NLP"

"What is YOLO ?"

"What is GPT model Architecture?"

ğŸ’¡ Future Enhancements
-------------------------------------------------------------------------
Allow PDF upload via Chainlit UI

Multi-document support

Add LangGraph-based agent flow

Integration with advanced vector DBs like Pinecone, Weaviate

Built with â¤ï¸ by Darpan using LangChain, Chainlit, and Gemini